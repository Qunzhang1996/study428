## 问题

C++中的内存管理是怎样的？



### 内存管理

分区方式一：

**代码段**：包括只读存储区和文本区，其中**只读存储区存储字符串常量**，**文本区存储程序的机器代码**。

**数据段**：存储程序中**已初始化的全局变量和静态变量**。

**BSS 段**：存储**未初始化的全局变量和静态变量（**局部+全局），以及**所有被初始化为0的全局变量和静态变量**。

> 补充：BSS段的BSS是英文 Block Started by Symbol 的简写

**堆区**：调用new/malloc函数时在堆区动态分配内存，同时需要调用delete/free来手动释放申请的内存。

**栈区**：使用栈空间存储**函数的返回地址、参数、局部变量、返回值**。

**映射区**：存储**动态链接库以及调用mmap函数进行的文件映射**。



分区方式二：

**栈区（stack）：**由编译器自动分配与释放，存放为运行时函数分配的局部变量、函数参数、返回值、返回地址等。

**堆区（heap）：**一般由程序员自动分配（使用new分配），如果程序员没有释放（使用delete释放），程序结束时系统自动回收。

**全局区（静态区）：**存放全局变量、静态数据、常量。程序结束后由系统释放。全局区分为已初始化全局区（data）和未初始化全局区（bss）。

**文字常量区：**存放常量字符串，程序结束后由系统释放。

**代码区：**存放函数体（类成员函数和全局区）的二进制代码。

### 内存分配

先看下面这张图：

![](https://i.loli.net/2020/05/25/HhwFfOpdaT5Z8sy.png)



