## 问题

什么是深拷贝与浅拷贝？



## 浅拷贝

C++中的浅拷贝是通过拷贝构造函数来实现的，如果程序员不主动编写拷贝构造函数和赋值函数，编译器将以浅拷贝的方式自动生成缺省的函数，也就是在拷贝时简单地复制某个对象的指针，这样很容易造成一些问题。

例如，假设String类有两个对象a和b，a.data的内容为“hello”，b.data为“world”，当将a的值赋给b时，可能会出现以下3个问题：

① b.data的内存没释放，**造成内存泄漏**

② b.data和a.data指向了同一块内存，a或b**任何一方的值改变都会修改另一方的值**

③ **在对象被析构时，data被释放了两次**



## 深拷贝

深拷贝**必须显式地提供拷贝构造函数和赋值运算符，而且新旧对象不共享内存**，也就是说，在编写拷贝构造函数时会开辟一个新的内存空间。那什么时候会使用深拷贝？

①一个对象以值传递的方式传入函数体

②一个对象以值传递的方式从函数体返回

③一个对象需要通过另外一个对象进行初始化



## 总结

C++中，浅拷贝不需要自己实现，编译器会自动生成缺省的拷贝构造函数，浅拷贝新旧对象共享一块内存，任何一方的值改变都会影响另一方；深拷贝需要自己手动编写拷贝构造函数，深拷贝新旧对象不共享内存。
